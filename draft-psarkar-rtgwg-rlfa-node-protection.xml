<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="4"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="std" docName="draft-psarkar-rtgwg-rlfa-node-protection" ipr="trust200902">

  <!-- ***** FRONT MATTER ***** -->

  <front>
    <title>Node Protection and Manageability for Remote-LFA</title>

    <!-- add 'role="editor"' below for the editors if appropriate -->

    <author initials="P." surname="Sarkar" fullname="Pushpasis Sarkar" role="editor">
      <organization>Juniper Networks, Inc.</organization>
      <address>
	<postal>
	  <street>Electra, Exora Business Park</street>
	  <city>Bangalore</city>
	  <region>KA</region>
	  <code>560103</code>
	  <country>India</country>
	</postal>
	<email>psarkar@juniper.net</email>
      </address>
    </author>

    <author fullname="Hannes Gredler" initials="H." surname="Gredler">
      <organization>Juniper Networks, Inc.</organization>
      <address>
	<postal>
	  <street>1194 N. Mathilda Ave.</street>
	  <city>Sunnyvale</city>
	  <region>CA</region>
	  <code>94089</code>
	  <country>US</country>
	</postal>
	<email>hannes@juniper.net</email>
      </address>
    </author>

    <author initials="S." surname="Hegde" fullname="Shraddha Hegde">
      <organization>Juniper Networks, Inc.</organization>
      <address>
	<postal>
	  <street>Electra, Exora Business Park</street>
	  <city>Bangalore</city>
	  <region>KA</region>
	  <code>560103</code>
	  <country>India</country>
	</postal>
	<email>shraddha@juniper.net</email>
      </address>
    </author>
    <author initials="H." surname="Raghuveer" fullname="Harish Raghuveer">
      <organization>Juniper Networks, Inc.</organization>
      <address>
	<postal>
	  <street>Electra, Exora Business Park</street>
	  <city>Bangalore</city>
	  <region>KA</region>
	  <code>560103</code>
	  <country>India</country>
	</postal>
	<email>hraghuveer@juniper.net</email>
      </address>
    </author>

    <date day="5" month="July" year="2013"/>

    <area>Routing</area>

    <workgroup>Routing Area Working Group</workgroup>

    <keyword>Remote-LFA</keyword>
    <keyword>IGP</keyword>
    <keyword>Node Protection</keyword>

    <abstract>
      <t>This document describes procedures for achieving node-protection,
      and collection of complete backup path characteristics.
      Knowledge about a backup path attributes is precursory to apply
      operator defined policy for eliminating paths not fitting
      constraints.</t>
    </abstract>

    <note title="Requirements Language">
      <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <xref
      target="RFC2119">RFC2119</xref>.</t>
    </note>
</front>

<middle>
  <section title="Introduction">
    <t>The current <xref target="I-D.ietf-rtgwg-remote-lfa">Remote-LFA</xref>
    specification only provides procedures for link-protection.
    The resulting Remote-LFA backup nexthops (also
    referred to as the PQ-nodes) does not guarantee node-protection for
    all destinations in case of failure of the primary nexthop node.</t>

    <t>Also, as an implication of the <xref
    target="I-D.litkowski-rtgwg-lfa-manageability">LFA
    Manageability</xref> document, in case, a computing router finds
    multiple Remote-LFA backup nexthops, a backup-selection policy
    configured on the computing router will require the Remote-LFA
    implementation to gather all the required path attributes along each
    link on Remote-LFA backup path. A backup path trough a Remote-LFA
    nexthop comprises two segments:</t>

    <t><list style="numbers">
      <t>a segment from the computing router to the PQ-node,</t>
      <t>a segment from the PQ-node to the destination node</t>
    </list></t>

    <t>With current LFA <xref target="RFC5286"/> and Remote-LFA
    implementation, SPF (and reverse SPF) is run with the computing router
    and its immediate 1-hop routers as the root. This allows
    computation of path attributes (e.g. SRLG, Admin-groups)
    for the first path segment. However, the computing
    router is unable to gather any path attributes
    for the second path segment (i.e. from the PQ-node to destination).
    Consecutively any policy-based selection
    of backup paths will consider only the path attributes
    from the computing router up until the PQ-node.</t>

    <t> This document describes a procedure for both
    guaranteeing node-protection with Remote-LFA, as well as, collection
    of complete path attributes (needed to facilitate policy-based backup
    path selection) for backup paths obtained with Remote-LFA.</t>
  </section>

    <section title="Node Protection with Remote-LFA">
    <section title="The Problem">
      <t>To better illustrate the problem and the solution proposed in
      this document the following topology diagram from the
      <xref target="I-D.ietf-rtgwg-remote-lfa">Remote-LFA</xref>,
      draft is being re-used with slight modification.</t>

        <figure anchor="ring-topology" title="Sample Ring Topology">
	    <artwork>
                            F
                           /
                      S-x-E
                     /     \
                    A       D--G
                     \     /
                      B---C
	    </artwork>
        </figure>

	<t>In the above topology, for all (non-ECMP) destinations
	reachable via the S-E link there is no standard LFA backup. As per the
	<xref target="I-D.ietf-rtgwg-remote-lfa">Remote-LFA</xref>
	specifications node C being the PQ-node for the S-E link provides
	backup nexthop for all the above destinations.
	<xref target="backup-path-table"/>, shows
	all possible primary and Remote-LFA backup paths for each
	destination.</t>

	<texttable anchor="backup-path-table" title="Backup paths with Remote-LFA">
	  <ttcol align="left">Destination</ttcol>
	  <ttcol align="left">Primary Path</ttcol>
	  <ttcol align="left">Remote-LFA Backup Path</ttcol>
	  <c>D</c>
	  <c>S->E->D</c>
	  <c>S->A->B->C->D</c>
	  <c>E</c>
	  <c>S->E</c>
	  <c>S->A->B->C->D->E</c>
	  <c>F</c>
	  <c>S->E->F</c>
	  <c>S->A->B->C->D->E->F</c>
	  <c>G</c>
	  <c>S->E->D->G</c>
	  <c>S->A->B->C->D->G</c>
	</texttable>

	<t>A closer look at <xref target="backup-path-table"/>
	shows that, while the
	PQ-node C provides link-protection for all the destinations, it does
	not provide node-protection for destinations E and F. In the event of
	the node-failure on primary nexthop E, the backup path from Remote-LFA
	nexthop C to E and F also becomes unavailable. So for a Remote-LFA
	nexthop to provide node-protection for a given destination, it is
	mandatory that, the shortest path from the given PQ-node to the given
	destination must not traverse the primary nexthop. </t>
    </section>

    <section title="The Solution">
      <t>This document proposes an additional forward SPF
      computation for each of the PQ-nodes,
      as a mechanism to provide node-protection with remote
      LFA. In case, a backup selection policy has been configured, the
      mechanism proposed, shall also provide a means to collect complete
      path attributes for the backup path via a Remote-LFA nexthop to a
      given destination.</t>

      <t>The additional forward SPF computation for
      each PQ-node, shall produce a list of links and
      nodes traversed on shortest paths from a given PQ-node to each of the
      destination in the whole network. To determine if a given PQ-node
      provides node-protecting backup for a given destination, the list of
      links and nodes from the given PQ-node to the given destination shall
      be inspected. In case the list contains the primary nexthop neighbor, the
      PQ-node does not provide node-protection. However, if the primary
      nexthop is not present in the list, the PQ-node guarantees
      node-protecting backup for the given destination. Below is an
      illustration of the mechanism with the topology in
      <xref target="ring-topology"/></t>

	<texttable anchor="table2" title="Types of protection with Remote-LFA">
	    <ttcol align="left">Destination</ttcol>
	    <ttcol align="left">PQ-node</ttcol>
	    <ttcol align="left">Shortest Path(PQ-node to Dest)</ttcol>
	    <ttcol align="left">Link-Protection</ttcol>
	    <ttcol align="left">Node-Protection</ttcol>
	    <c>D</c>
	    <c>C</c>
	    <c>C->D</c>
	    <c>Yes</c>
	    <c>Yes</c>
	    <c>E</c>
	    <c>C</c>
	    <c>C->D->E</c>
	    <c>Yes</c>
	    <c>No</c>
	    <c>F</c>
	    <c>C</c>
	    <c>C->D->E->F</c>
	    <c>Yes</c>
	    <c>No</c>
	    <c>G</c>
	    <c>C</c>
	    <c>C->D->G</c>
	    <c>Yes</c>
	    <c>Yes</c>
	</texttable>

	<t>As seen in the above example while C is node-protecting
	Remote-LFA nexthop for D and G, it is not so for E and F, since the
	primary nexthop E is in the shortest path from C to E and F.</t>

    </section>
  </section>

  <section title="Facilitating Manageabilty of Remote-LFA Backup Paths">
    <section title="The Problem">
      <t>With the regular Remote-LFA
      functionality the computing router may compute more than one PQ-node
      as usable Remote-LFA backup nexthops. Additionally a backup selection
      policy may be configured to enable the network operator to choose one
      of them as the most appropriate Remote-LFA nexthop. For such back
      selection policy to run, all the relevant path attributes for each of
      the backup paths (one through each of the PQ-nodes), will need to be
      collected. The Remote-LFA backup path via a given PQ-node to a given
      destination comprises of two path segments as follows.</t>
      <t><list style="numbers">

	<t>Path segment from the computing router to the
	PQ-node (Remote-LFA backup nexthop), and</t>

	<t>Path segment from the PQ-node to the destination
	we are trying to protect. </t>
      </list></t>

      <t>The first Path segment can be calculated from the regular
      forward SPF done as part of standard and remote LFA
      computations. However without the mechanism proposed in this
      invention, there is no way to determine the path attributes for
      the second path segment. In the absence of the path attributes
      for the second path segment, two Remote-LFA backup path may be
      evaluated only based on the first path segments attributes,
      although the second path segment attributes may be different.</t>
    </section>

    <section title="The Solution">
      <t>The additional forward SPF computation being proposed in this document
      shall also collect links, nodes and path attributes along the
      second path segment.
      This shall enable collection of complete path attributes for a
      given Remote-LFA backup path to a given destination. The complete
      backup path attributes shall then facilitate more appropriate
      backup path selection while running the backup
      selection policy.</t>
    </section>
  </section>

  <section title="Prior Solutions">
    <t>A recent <xref
    target="I-D.litkowski-rtgwg-node-protect-remote-lfa">
    Node Protecting Remote-LFA</xref> draft proposes a solution for
    providing node-protection with Remote-LFA. It requires the
    computing router to additionally run reverse SPFs rooted at the
    nextnexthop routers (i.e. all the 2-hop neighborhood) as well.
    A simple study of standard IGP network topologies in real-life
    deployments shall reveal that, the increase in the number of required
    SPF computations is exponential, and can be a substantial computation
    overhead.</t>

    <section title="Advantage of this Proposal">
      <t>Following are the advantages of the mechanism proposed in this
      document.</t>
      <t><list style="symbols"> <t>The recent Remote-LFA
      node-protection document
      <xref target="I-D.litkowski-rtgwg-node-protect-remote-lfa"/>
      proposes an extra reverse SPF computation for each nextnexthop of the computing
      router. The mechanism in this document proposes an extra forward SPF
      for each of the PQ-nodes. Considering some of the standard IGP network
      topologies in real-life service-provider deployments, the number of
      nextnexthops will be substantially higher than the number of PQ-nodes
      discovered in those topologies. Hence the number of additional SPFs
      required in the proposed mechanism in this invention disclosure will
      be considerably less than compared to the procedures outlined in
      <xref target="I-D.litkowski-rtgwg-node-protect-remote-lfa"/>,
      and hence imply less computing overhead.</t>
      
      <t>Also the extra reverse SPF proposed per nextnexthop
      in Remote-LFA node-protection specification
      <xref target="I-D.litkowski-rtgwg-node-protect-remote-lfa"/> does not provide
      a means to collect the path attributes for the backup path segment
      from the PQ-node to a given destination. The additional forward SPF
      for each PQ-node, as proposed in this document facilitates this.</t>
      </list></t>
    </section>
  </section>

    <section anchor="Acknowledgements" title="Acknowledgements">
      <t></t>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>
	N/A. - No protocol changes are proposed in this document.
      </t>

    </section>

    <section anchor="Security" title="Security Considerations">
      <t>This document does not introduce any change in any of the
      protocol specifications. It simply proposes to run an extra SPF rooted
      on each PQ-node discovered in the whole network.</t>
    </section>
  </middle>

  <!--  *****BACK MATTER ***** -->

  <back>

    <references title="Normative References">
      <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?>
    </references>

    <references title="Informative References">
      <?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.5286.xml"?>
      <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-ietf-rtgwg-remote-lfa-02.xml"?>
      <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-litkowski-rtgwg-lfa-manageability-01.xml"?>
      <?rfc include="http://xml.resource.org/public/rfc/bibxml3/reference.I-D.draft-litkowski-rtgwg-node-protect-remote-lfa-00.xml"?>
    </references>

  </back>
</rfc>
